<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â§úËé∫‰∏éÁõ≤ÂæãÂ∏à</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #1A1A1A;
            color: #E0C0D0;
            font-family: 'Segoe UI', sans-serif;
        }

        .status-bar {
            background: #2D2C2E;
            padding: 8px;
            color: #B7608A;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .chat-container {
            max-width: 375px;
            margin: 20px auto;
            height: 90vh;
            display: flex;
            flex-direction: column;
        }

        #chat-box {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            background: #0F0F12;
        }

        .message {
            max-width: 80%;
            margin: 15px 0;
            animation: fadeIn 0.3s;
        }

        .npc-message {
            background: #4A3A4B;
            color: #E8D0E0;
            border-radius: 15px 15px 15px 3px;
            padding: 12px;
            margin-left: 10px;
            position: relative;
        }

        .player-message {
            background: #B7608A;
            color: #FFF;
            border-radius: 15px 15px 3px 15px;
            padding: 12px;
            margin-right: 10px;
            margin-left: auto;
        }

        .timestamp {
            font-size: 10px;
            color: #6A5D6E;
            margin: 5px 10px;
        }

        .typing-indicator {
            display: flex;
            padding: 8px;
            color: #B7608A;
            animation: typing 1s infinite;
        }

        .media-message {
            background: #000;
            border-radius: 10px;
            padding: 8px;
            margin: 5px 0;
        }

        @keyframes typing {
            from { opacity: 0.5; }
            to { opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .options {
            margin: 10px;
            border-top: 1px solid #3A2D39;
            padding-top: 15px;
        }

body {
    margin: 0;
    padding: 0;
    background: #1A1A1A;
    color: #E0C0D0;
    font-family: 'Segoe UI', sans-serif;
}

.status-bar {
    background: #2D2C2E;
    padding: 8px;
    color: #B7608A;
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    font-weight: bold;
}

.chat-container {
    max-width: 375px;
    margin: 20px auto;
    height: 90vh;
    display: flex;
    flex-direction: column;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

#chat-box {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
    background: #0F0F12;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.message {
    max-width: 80%;
    margin: 15px 0;
    animation: fadeIn 0.3s ease-in-out;
}

.npc-message {
    background: #4A3A4B;
    color: #E8D0E0;
    border-radius: 15px 15px 15px 3px;
    padding: 12px;
    margin-left: 10px;
    position: relative;
}

.player-message {
    background: #B7608A;
    color: #FFF;
    border-radius: 15px 15px 3px 15px;
    padding: 12px;
    margin-right: 10px;
    margin-left: auto;
}

.timestamp {
    font-size: 10px;
    color: #6A5D6E;
    margin: 5px 10px;
    text-align: right;
}

.typing-indicator {
    display: flex;
    padding: 8px;
    color: #B7608A;
    font-style: italic;
    animation: typing 1s infinite;
}

.media-message {
    background: #222;
    border-radius: 10px;
    padding: 10px;
    margin: 5px 0;
    text-align: center;
    font-weight: bold;
}

@keyframes typing {
    from { opacity: 0.5; }
    to { opacity: 1; }
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.options {
    border-top: 1px solid #3A2D39;
    padding: 15px;
    background: #1F1D1F;
}

button {
    background: #3A2D39;
    border: none;
    color: #E0C0D0;
    padding: 12px;
    margin: 8px 0;
    border-radius: 20px;
    width: 100%;
    text-align: center;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s ease-in-out;
}

button:hover {
    background: #4A3A4B;
}

.avatar {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    margin-right: 10px;
    vertical-align: middle;
    background-color: #4A3A4B;
    display: inline-block;
}

.chat-container::-webkit-scrollbar {
    width: 6px;
}

.chat-container::-webkit-scrollbar-thumb {
    background: #6A5D6E;
    border-radius: 10px;
}

.chat-container::-webkit-scrollbar-track {
    background: #0F0F12;
}

        .avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="status-bar">
        <span>üì∂ 5G | 97%</span>
        <span>03:47</span>
    </div>
    
    <div class="chat-container">
        <div id="chat-box"></div>
        <div class="options">
            <button onclick="startChat()">üì± ÂºÄÂßãÂä†ÂØÜÂØπËØù</button>
        </div>
    </div>

    <script>
        const chatBox = document.getElementById("chat-box");
        let affection = 0;
        let chatPhase = 0;

        const dialogues = [
            {
                npc: `üì± È©¨ÁâπÔºö*ÈúáÂä®*\nÔºàÂèëÈÄÅÊ®°Á≥äÁöÑÂ±ãÈ°∂ÁõëÊéßÊà™ÂõæÔºâ\n"03:47ÁöÑËÆøÂÆ¢ËØ•‰∫§ÂÅúËΩ¶Ë¥π‰∫Ü\n‰∏äÊ¨°ÁöÑÂºπÂ≠îË¥¶ÂçïËøòÊ≤°ÁªìÊ∏ÖÔºü"`,
                options: [
                    {
                        text: `"‰Ω†ÂÆ∂ÁöÑÂíñÂï°ÈöæÂñùÂæóÂÉèÊ¥óÁ¢óÊ∞¥\n‰∏çÂ¶ÇÁî®Áª¥‰øÆË¥πÊç¢ÊÉÖÊä•Ôºü"`,
                        effect: +20,
                        response: `üì± È©¨ÁâπÔºö*Ê≠£Âú®ËæìÂÖ•...*\n"ËÆ∞Âæó‰Ω†Ê¨†Êàë...\n‚ë† 3Ê¨°Êó†‰∫∫Êú∫ÊîØÊè¥\n‚ë° Âîê‰∫∫Ë°óÈÇ£ÊôöÁöÑÁúüÁõ∏\n‚ë¢ ÁôΩÁé´Áë∞ÁöÑÁ∫¶ÂÆö"`
                    },
                    {
                        text: `*ÂèëÈÄÅÊàòÊúØÂåïÈ¶ñÁÖßÁâá*\n"Êñ∞Áé©ÂÖ∑ÔºåÊÉ≥ËØïËØïÂêóÔºü\nÔºàÂÆö‰ΩçÂÖ±‰∫´Ôºö‰Ω†ÁöÑÂÖ¨ÂØìÔºâ"`,
                        effect: +30,
                        response: `üì± È©¨ÁâπÔºö*Â∑≤ËØª 03:49*\nÔºà‰ΩçÁΩÆÊõ¥Êñ∞Ôºö0.3kmÊé•Ëøë‰∏≠Ôºâ\n"Âª∫ËÆÆÂÖàËóèÂ•ΩÂ®ÅÂ£´Âøå\nÂíåÈÇ£‰ª∂ÈªëËâ≤‰∏ùÁª∏Áù°Ë°£"`
                    }
                ]
            },
            {
                npc: `üì± È©¨ÁâπÔºö*ËØ≠Èü≥Ê∂àÊÅØ 12s*\nÔºàËÉåÊôØÊû™Â£∞Ôºâ\n"ÈáëÂπ∂ÁöÑË¥ßËàπÊúâ...ÔºàÁàÜÁÇ∏Â£∞Ôºâ\nÂçÅ‰∫å‰∏™Â≠©Â≠ê...ÔºàÂñòÊÅØÔºâÈúÄË¶Å..."`,
                options: [
                    {
                        text: `*ÂèëÈÄÅÊ≠¶Âô®Ê∏ÖÂçï*\n"ËÄÅËßÑÁü©Ôºö‰Ω†ËØ±ÊïåÊàëÊãÜÂºπ\nÊêûÁ†∏Â∞±Ëµî‰∏âÂÄçÂ§úËßÜÈïúÈí±"`,
                        effect: +40,
                        response: `üì± È©¨ÁâπÔºö*Âä†ÂØÜÊñá‰ª∂Êé•Êî∂*\n"Ë°åÂä®Êó∂Èó¥04:30\nPS.‰Ω†‰∏äÊ¨°ÁöÑ‰º§Áñ§\nÊØîÊàëÁöÑÊõ¥ÊòéÊòæ"`
                    },
                    {
                        text: `*ÂèëÈÄÅÂºóÂÖ∞ÂÖãÈÄöÁºâ‰ª§*\n"ÊÉ©ÁΩöËÄÖËØ¥ÊòØÈô∑Èò±\n‰Ω†ÁûíÁùÄÁöÑ‰∫ãÊúÄÂ•ΩÁé∞Âú®‰∫§‰ª£"`,
                        effect: -20,
                        response: `üì± È©¨ÁâπÔºö*Êí§Âõû‰∏ÄÊù°Ê∂àÊÅØ*\n"...‰Ω†ÊûúÁÑ∂ÁïôÁùÄ‰∏âÂπ¥ÂâçÁöÑÂΩïÈü≥\nÈÇ£‰∏™Á∫¢ÂèëÂ•≥Â≠©ÁöÑÁúºÁùõ..."`
                    }
                ]
            },
            {
                npc: `üì± È©¨ÁâπÔºö*ÂèëÈÄÅËàûËπàÊïôÂ≠¶ÈìæÊé•*\n"Ê¨†‰Ω†ÁöÑÊé¢ÊààËØæ\nÔºàÈôÑÔºöÈò≤ÂºπËàûÈûãË¥≠‰π∞ÈìæÊé•Ôºâ"`,
                options: [
                    {
                        text: `*Êí≠ÊîæÊóßÂΩïÈü≥ÁâáÊÆµ*\n"Ê¥ª‰∏ãÊù•Â∞±Êïô‰Ω†Áî®ÂåïÈ¶ñË∑≥ÂçéÂ∞îÂÖπ\nÔºàÂØÜÁ†ÅÔºö‰Ω†ÁîüÊó•+ÊàëÂ§±ÊâãÊó•Ôºâ"`,
                        effect: +50,
                        response: `üì± È©¨ÁâπÔºö*‰ΩçÁΩÆÂÖ±‰∫´ÂºÄÂêØ*\n"04:45Á†ÅÂ§¥ËßÅ\n‰Ω†ÁöÑÈ¶ôÊ∞¥...ÂíåÂàùÈÅáÊó∂‰∏ÄÊ†∑"`
                    },
                    {
                        text: `*ÂèëÈÄÅÁáÉÁÉßËÉåÊôØËá™Êãç*\n"Âà´Ë∑üÊù•ÔºåÂ¢ìÁ¢ëÂâçÊîæ...\nÔºàÊñá‰ª∂Âä†ÂØÜÔºöÊúÄÂêéÁïôË®ÄÔºâ"`,
                        effect: -100,
                        response: `üì± È©¨ÁâπÔºö*ÊúÄÁªàÂÆö‰ΩçÊõ¥Êñ∞*\n"‰Ω†Âøò‰∫Ü\nÊàë‰ªé‰∏çÁõ∏‰ø°ÈªéÊòé..."`
                    }
                ]
            }
        ];

        function createMessage(text, isPlayer) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isPlayer ? 'player-message' : 'npc-message'}`;
            
            // Ê∑ªÂä†Â§¥ÂÉè
            if (!isPlayer) {
                const avatar = document.createElement('img');
                avatar.className = 'avatar';
                avatar.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%234A3A4B'/%3E%3Cpath d='M30,65 Q50,80 70,65 M40,40 Q50,30 60,40' stroke='%23E8D0E0' stroke-width='4' fill='none'/%3E%3C/svg%3E";
                messageDiv.prepend(avatar);
            }

            // Â§ÑÁêÜÂ§öÂ™í‰ΩìÂÜÖÂÆπ
            text.split('\n').forEach(line => {
                const p = document.createElement('p');
                if(line.includes("*ÂèëÈÄÅ")) {
                    p.innerHTML = `üìé ${line.replace('*ÂèëÈÄÅ', '')}`;
                    p.style.color = '#B7608A';
                } else {
                    p.textContent = line;
                }
                messageDiv.appendChild(p);
            });

            // Ê∑ªÂä†Êó∂Èó¥Êà≥
            const time = new Date().toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit', 
                hour12: false 
            }).replace('24:', '00:');
            const timeStamp = document.createElement('div');
            timeStamp.className = 'timestamp';
            timeStamp.textContent = isPlayer ? '‚úì Â∑≤ÈÄÅËææ' : `üï∂ Â∑≤ËØª ${time}`;
            
            const container = document.createElement('div');
            container.appendChild(messageDiv);
            if(!isPlayer) container.appendChild(timeStamp);
            
            return container;
        }

        function showTyping() {
            const typing = document.createElement('div');
            typing.className = 'typing-indicator';
            typing.innerHTML = 'üï∂ È©¨ÁâπÊ≠£Âú®ËæìÂÖ•...';
            chatBox.appendChild(typing);
            chatBox.scrollTop = chatBox.scrollHeight;
            return typing;
        }

        async function addMessage(text, isPlayer = false) {
            if(!isPlayer) {
                const typing = showTyping();
                await new Promise(r => setTimeout(r, 1500));
                typing.remove();
            }
            
            const message = createMessage(text, isPlayer);
            chatBox.appendChild(message);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        async function selectOption(option) {
            // Ê∏ÖÈô§ÈÄâÈ°π
            document.querySelector('.options').innerHTML = '';
            
            await addMessage(option.text, true);
            affection += option.effect;
            
            // ÊòæÁ§∫NPCÂõûÂ∫î
            await new Promise(r => setTimeout(r, 800));
            await addMessage(option.response);
            
            chatPhase++;
            if(chatPhase < dialogues.length) {
                await showNextDialogue();
            } else {
                showEnding();
            }
        }

        async function showNextDialogue() {
            const current = dialogues[chatPhase];
            await addMessage(current.npc);
            
            const optionsDiv = document.querySelector('.options');
            optionsDiv.innerHTML = current.options.map((opt, i) => `
                <button onclick="selectOption(${i})">
                    ${opt.text.replace(/\n/g, '<br>')}
                </button>
            `).join('');
        }

        function showEnding() {
            const endings = [
                { threshold: -100, text: "üåπÁªàÂ±ÄÔºöÊû™Âè£‰∏ãÁöÑÁôΩÁé´Áë∞\nÔºàÂ•ΩÊÑüÂ∫¶Ôºö"+affection+"Ôºâ" },
                { threshold: -50, text: "üíîÁªàÂ±ÄÔºöÊ∞∏‰∏çÊÑàÂêàÁöÑÊóß‰º§\nÔºàÂ•ΩÊÑüÂ∫¶Ôºö"+affection+"Ôºâ" },
                { threshold: 0, text: "üåÉÁªàÂ±ÄÔºöÁÜüÊÇâÁöÑÈôåÁîü‰∫∫\nÔºàÂ•ΩÊÑüÂ∫¶Ôºö"+affection+"Ôºâ" },
                { threshold: 50, text: "üîóÁªàÂ±ÄÔºöÂç±Èô©ÂÖ±Áîü‰Ωì\nÔºàÂ•ΩÊÑüÂ∫¶Ôºö"+affection+"Ôºâ" },
                { threshold: 100, text: "üíÉÁªàÂ±ÄÔºöË°ÄËâ≤Êé¢Êàà\nÔºàÂ•ΩÊÑüÂ∫¶Ôºö"+affection+"Ôºâ" }
            ];
            
            const result = endings.reverse().find(e => affection >= e.threshold);
            addMessage(`‚ñà‚ñà Âä†ÂØÜËøûÊé•Â∑≤Êñ≠ÂºÄ ‚ñà‚ñà\n${result.text}`);
        }

        async function startChat() {
            chatBox.innerHTML = '';
            document.querySelector('.options').innerHTML = 'üîÑ ËøûÊé•Âä†ÂØÜÈ¢ëÈÅì‰∏≠...';
            await new Promise(r => setTimeout(r, 2000));
            chatPhase = 0;
            affection = 0;
            await showNextDialogue();
        }

        // Êö¥Èú≤ÂáΩÊï∞ÁªôÊåâÈíÆ
        window.selectOption = (index) => selectOption(dialogues[chatPhase].options[index]);
        window.startChat = startChat;
    </script>
</body>
</html>
